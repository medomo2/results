import streamlit as st
import pandas as pd

# 1. ุชุธุจูุท ุดูู ุงูุตูุญุฉ
st.set_page_config(page_title="ูุชูุฌุฉ ุงูุทูุงุจ", page_icon="๐", layout="centered")

# ุนููุงู ุงููููุน
st.title("๐ ูุธุงู ุงูุงุณุชุนูุงู ุนู ุงููุชูุฌุฉ")

# 2. ููุงู ุฑูุน ุงูููู
uploaded_file = st.file_uploader("ุงุฑูุน ููู ุงููุชูุฌุฉ (Excel)", type=['xlsx'])

if uploaded_file is not None:
    try:
        # 3. ูุฑุงุกุฉ ุงูููู (ุงูุชุฑูุฉ ููุง: ุจููููู ุงูุฑุง ูู ุญุงุฌุฉ ููุตูุต ุนุดุงู ุงูุฑูู ุงูุทููู ููุจูุธุด)
        df = pd.read_excel(uploaded_file, dtype=str)
        
        # ุจูุดูู ุฃู ูุณุงูุงุช ุฒูุงุฏุฉ ูู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ุนุดุงู ููุญุตูุด ูุดุงูู
        df.columns = df.columns.str.strip()

        # 4. ุฎุงูุฉ ุงูุจุญุซ
        st.write("### ุฃุฏุฎู ุงูููุฏ ุงูุฎุงุต ุจู:")
        # ุนูููุง ูุซุงู ุนุดุงู ุงูุทุงูุจ ูููู ููุชุจ ุฅูู
        student_code = st.text_input("ูุซุงู: 120250004617", "")

        if st.button("ุจุญุซ ุนู ุงููุชูุฌุฉ"):
            if student_code:
                # ุงูุชุฃูุฏ ุฅู ุงูุนููุฏ ุงููู ุจูุฏูุฑ ููู ุงุณูู 'Code'
                # ูุงุฒู ูู ููู ุงูุฅูุณู ุจุชุงุนู ูููู ุงุณู ุงูุนููุฏ Code
                if 'Code' in df.columns:
                    # ุชูุธูู ุงูุจูุงูุงุช ูู ุฃู ูุณุงูุงุช
                    df['Code'] = df['Code'].astype(str).str.strip()
                    search_val = str(student_code).strip()

                    # ุนูููุฉ ุงูุจุญุซ
                    result = df[df['Code'] == search_val]

                    if not result.empty:
                        st.success(f"โ ูุจุฑูู! ุชู ุงูุนุซูุฑ ุนูู ุงููุชูุฌุฉ.")
                        st.dataframe(result, hide_index=True)
                    else:
                        st.error("โ ุงูุฑูู ุฏู ูุด ููุฌูุฏุ ุงุชุฃูุฏ ุฅูู ูุงุชุจู ุตุญ.")
                else:
                    st.error("โ๏ธ ููู ุงูุฅูุณู ูููููุด ุนููุฏ ุงุณูู 'Code'. ูุฑุฌู ุชุณููุฉ ุนููุฏ ุฑูู ุงูุฌููุณ ุจู Code.")
            else:
                st.warning("ุงูุชุจ ุงูููุฏ ุงูุฃูู!")
                
    except Exception as e:
        st.error(f"ูู ูุดููุฉ ูู ุงูููู: {e}")

else:
    st.info("ูุณุชูู ุชุฑูุน ุงูููู ูุง ุฑูุณ ุนุดุงู ุฃุดุชุบู...")
